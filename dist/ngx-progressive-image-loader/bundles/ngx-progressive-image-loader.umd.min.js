!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("ngx-window-token"),require("@angular/platform-browser"),require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-progressive-image-loader",["exports","@angular/common","ngx-window-token","@angular/platform-browser","@angular/core"],t):t(e["ngx-progressive-image-loader"]={},e.ng.common,e.ngxWindowToken,e.ng.platformBrowser,e.ng.core)}(this,function(e,t,r,n,i){"use strict";var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=new i.InjectionToken("Image loader Config"),a={rootMargin:"10px",threshold:.1,imageRatio:16/9,placeholderImageSrc:""},c=function(){function e(e){this.setConfig(e)}return e.prototype.setConfig=function(e){this.config=e?o({},a,e):a},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:i.Inject,args:[s]}]}]},e}();function g(e){return e&&"IntersectionObserver"in e&&"IntersectionObserverEntry"in e&&"intersectionRatio"in e.IntersectionObserverEntry.prototype}function l(e,t,r){e.setAttribute(r,t,r.dataset[t])}function p(e){return"PICTURE"===e.nodeName}function d(e,t){if(p(t.parentElement))for(var r=t.parentElement.children,n=0;n<r.length;n++){var i=r[n];i instanceof HTMLSourceElement?l(e,"srcset",i):i instanceof HTMLImageElement&&l(e,"src",i)}else t.dataset.src&&l(e,"src",t),t.dataset.srcset&&l(e,"srcset",t)}function m(e){return e&&!("onscroll"in e)||/(gle|ing|ro)bot|crawl|spider/i.test(e.navigator.userAgent)}var u=function(){function e(e,t,r,n,i){this._Renderer=t,this._ConfigurationService=r,this.platformId=n,this.window=i}return e.prototype.ngOnInit=function(){g(this.window)&&!m(this.window)&&t.isPlatformBrowser(this.platformId)&&(this.imageRatio||(this.imageRatio=this._ConfigurationService.config.imageRatio),this.filter||(this.filter=this._ConfigurationService.config.filter),this.placeholderImageSrc||(this.placeholderImageSrc=this._ConfigurationService.config.placeholderImageSrc),this.intersectionObserver=new IntersectionObserver(this.onIntersectionChanged.bind(this),this._ConfigurationService.config))},e.prototype.onIntersectionChanged=function(e,t){var r=this;e.forEach(function(e){return e.isIntersecting&&r.onImageAppearsInViewport(e.target,t)})},e.prototype.onImageAppearsInViewport=function(e,t){t.unobserve(e),d(this._Renderer,e)},e.prototype.ngOnDestroy=function(){this.intersectionObserver&&this.intersectionObserver.disconnect()},e.decorators=[{type:i.Component,args:[{selector:"ngx-progressive-image-loader",template:"\n    <ng-content></ng-content>\n  "}]}],e.ctorParameters=function(){return[{type:i.ElementRef},{type:i.Renderer2},{type:c},{type:undefined,decorators:[{type:i.Inject,args:[i.PLATFORM_ID]}]},{type:undefined,decorators:[{type:i.Inject,args:[r.WINDOW]}]}]},e.propDecorators={imageRatio:[{type:i.Input}],filter:[{type:i.Input}],placeholderImageSrc:[{type:i.Input}]},e}(),h=function(){function e(e,t){this.sanitizer=e,this._ProgressiveImageLoader=t,this["class"]="ngx-image-placeholder"}return Object.defineProperty(e.prototype,"placeHolder",{get:function(){return this.sanitizer.bypassSecurityTrustStyle("padding-bottom: "+100/(this.imageRatio||this._ProgressiveImageLoader.imageRatio)+"%;")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageFilter",{get:function(){return this.sanitizer.bypassSecurityTrustStyle(""+this._ProgressiveImageLoader.filter)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"safeLoadingImage",{get:function(){return this.sanitizer.bypassSecurityTrustUrl(this.placeholderImageSrc||this._ProgressiveImageLoader.placeholderImageSrc)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.decorators=[{type:i.Component,args:[{selector:"ngx-image-placeholder",template:'\n    <img class="placeholder-loading-image" [src]="safeLoadingImage" [style.filter]="imageFilter" />\n    <ng-content></ng-content>\n  ',changeDetection:i.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:n.DomSanitizer},{type:u}]},e.propDecorators={"class":[{type:i.HostBinding,args:["class"]}],placeHolder:[{type:i.HostBinding,args:["style"]}],imageRatio:[{type:i.Input}],placeholderImageSrc:[{type:i.Input}]},e}(),f=function(){function e(e,t,r,n,i,o){this._ElementRef=e,this._Renderer=t,this.window=r,this._ConfigurationService=n,this._ImagePlaceholder=i,this._ProgressiveImageLoader=o,this.noPlaceholder=!1,this.isObserve=!1}return Object.defineProperty(e.prototype,"imageRatio",{get:function(){return this._imageRatio||this._ProgressiveImageLoader.imageRatio},set:function(e){this._imageRatio=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"placeholderImageSrc",{get:function(){return this._placeholderImageSrc||this._ProgressiveImageLoader.placeholderImageSrc},set:function(e){this._placeholderImageSrc=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.imageElement=this._ElementRef.nativeElement,this.setDataSrc("data-src",this.src),this.setDataSrc("data-srcset",this.srcset),this._ProgressiveImageLoader.intersectionObserver?this.imageElement instanceof HTMLImageElement&&(this.isObserve=!0,this._ProgressiveImageLoader.intersectionObserver.observe(this.imageElement),this.imageElement.onload=function(){e.imageElement.classList.add("loaded")},this._ImagePlaceholder||this.noPlaceholder||this.setPlaceholder()):(d(this._Renderer,this.imageElement),this.imageElement.classList.add("loaded"))},e.prototype.ngOnChanges=function(e){e.src&&!e.src.isFirstChange()&&this.setDataSrc("data-src",this.src),e.srcset&&!e.srcset.isFirstChange()&&this.setDataSrc("data-srcset",this.srcset),this.isObserve&&(e.src&&!e.src.isFirstChange()||e.srcset&&!e.srcset.isFirstChange())&&(this._ProgressiveImageLoader.intersectionObserver.unobserve(this.imageElement),this._ProgressiveImageLoader.intersectionObserver.observe(this.imageElement))},e.prototype.setDataSrc=function(e,t){t&&this._Renderer.setAttribute(this.imageElement,e,t)},e.prototype.setPlaceholder=function(){var e=this.imageElement.parentElement,t=this.createPlaceholder(this.createPlaceholderImage());if(p(e)){var r=e.parentElement;this.insertPlaceholder(r,e,t)}else this.insertPlaceholder(e,this.imageElement,t)},e.prototype.insertPlaceholder=function(e,t,r){e.insertBefore(r,t),r.style.paddingBottom=100/this.imageRatio+"%",r.appendChild(t)},e.prototype.createPlaceholder=function(e){var t=document.createElement("div");return t.classList.add("ngx-image-placeholder"),t.appendChild(e),t},e.prototype.createPlaceholderImage=function(){var e=new Image;return e.classList.add("placeholder-loading-image"),e.style.filter=this._ProgressiveImageLoader.filter,e.src=this.placeholderImageSrc,e},e.decorators=[{type:i.Directive,args:[{selector:"img[ngxProgressiveImage], source[ngxProgressiveImage]"}]}],e.ctorParameters=function(){return[{type:i.ElementRef},{type:i.Renderer2},{type:undefined,decorators:[{type:i.Inject,args:[r.WINDOW]}]},{type:c},{type:h,decorators:[{type:i.Optional},{type:i.Inject,args:[h]}]},{type:u,decorators:[{type:i.Inject,args:[u]}]}]},e.propDecorators={imageRatio:[{type:i.Input}],placeholderImageSrc:[{type:i.Input}],src:[{type:i.Input}],srcset:[{type:i.Input}],noPlaceholder:[{type:i.Input}]},e}();function I(e){return new c(e)}var y=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:s,useValue:e},{provide:c,useFactory:I,deps:[s]}]}},t.decorators=[{type:i.NgModule,args:[{imports:[],declarations:[u,f,h],exports:[u,f,h]}]}],t}();e.ProgressiveImageLoaderComponent=u,e.ProgressiveImageDirective=f,e.ImagePlaceholderComponent=h,e.ConfigurationServiceFactory=I,e.NgxProgressiveImageLoaderModule=y,e.IMAGE_LOADER_CONFIG_TOKEN=s,e.DEFAULT_IMAGE_LOADER_OPTIONS=a,e.isSupportIntersectionObserver=g,e.isImagePicture=function v(e){return e instanceof HTMLImageElement||e instanceof HTMLPictureElement},e.setAttribute=l,e.isPictureElement=p,e.loadImage=d,e.isSpider=m,e.Éµa=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-progressive-image-loader.umd.min.js.map